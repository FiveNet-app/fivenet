syntax = "proto3";

package services.centrum;
option go_package = "github.com/galexrt/fivenet/gen/go/proto/services/centrum;centrum";

import "resources/dispatch/dispatch.proto";

// Unit Management

message ListUnitsRequest {
  repeated resources.dispatch.UNIT_STATUS status = 1;
  optional string name = 2;
}

message ListUnitsResponse {
  repeated resources.dispatch.Unit units = 1;
}

message CreateUnitRequest {
  resources.dispatch.Unit unit = 1;
}

message CreateUnitResponse {
  resources.dispatch.Unit unit = 1;
}

message UpdateUnitRequest {
  resources.dispatch.Unit unit = 1;
}

message UpdateUnitResponse {
  resources.dispatch.Unit unit = 1;
}

message DeleteUnitRequest {
  uint64 unit_id = 1;
}

message DeleteUnitResponse {}

message AssignUnitRequest {
  uint64 unit_id = 1;
  repeated int32 to_add = 2;
  repeated int32 to_remove = 3;
}

message AssignUnitResponse {
  uint64 unit_id = 1;
}

message UnitStreamRequest {}

message UnitStreamResponse {
  repeated UnitChanges changes = 1;
}

message UnitChanges {
  uint64 id = 1;
  repeated int32 added = 2;
  repeated int32 removed = 3;
}

service UnitService {
  // @perm
  rpc ListUnits(ListUnitsRequest) returns (ListUnitsResponse);
  // @perm
  rpc CreateUnit(CreateUnitRequest) returns (CreateUnitResponse);
  // @perm: Name=CreateUnit
  rpc UpdateUnit(UpdateUnitRequest) returns (UpdateUnitResponse);
  // @perm: Name=DeleteUnit
  rpc DeleteUnit(DeleteUnitRequest) returns (DeleteUnitResponse);

  // @perm: Attrs=Access/StringList:[]string{"Own", "Lower_Rank", "Same_Rank"}ยง[]string{"Own"}
  rpc AssignUnit(AssignUnitRequest) returns (AssignUnitResponse);

  // @perm
  rpc StreamUnits(UnitStreamRequest) returns (stream UnitStreamResponse);
}

// Dispatch Management

message CreateDispatchRequest {

}

message CreateDispatchResponse {

}

// TODO

message CentrumStreamRequest {}

message CentrumStreamResponse {}

service CentrumService {
  // @perm
  rpc CreateDispatch(CreateDispatchRequest) returns (CreateDispatchResponse);
  // TODO

  // @perm
  rpc Stream(CentrumStreamRequest) returns (stream CentrumStreamResponse);
}
